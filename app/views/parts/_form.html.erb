<%= error_messages_for 'part' %>

<div class="box tabular">
<p><%= f.text_field :name, :size => 30, :required => true, :label => l(:label_cms_part_name)  %></p>
<p><%= f.select :part_type, options_for_select(parts_type_collection,  @part.part_type), :label => l(:label_cms_part_type) %></p>

<p><%= f.select :content_type, options_for_select([["Textile", "textile"], ["HTML", "html"], ["CSS", "css"], ["JavaScript", "java_script"]],  @part.content_type), :label => l(:label_cms_part_content_type) %></p>

<p><%= f.check_box :is_cached, :label => l(:label_cms_is_cached) %></p>

<p id="attachments_form"><label><%= l(:label_attachment_plural) %></label><%= render :partial => 'attachments/form', :locals => {:container => @part} %></p>

<%= text_area_tag 'part[content]', @part.content, :cols => 100, :rows =>  30, :class => 'wiki-edit' %>

<%= javascript_tag "editor = activateCodeMirror('part_content');" %>
<%= javascript_tag "$('.contextual.page-edit').draggable();" %>

</div>


<% content_for :header_tags do %>
  <%= javascript_include_tag 'codemirror/codemirror', :plugin => 'redmine_cms'  %>
  <%= javascript_include_tag 'codemirror/emmet', :plugin => 'redmine_cms'  %>
  <%= javascript_include_tag 'codemirror/addon/mode/overlay', :plugin => 'redmine_cms'  %>
  <%= javascript_include_tag 'codemirror/addon/search/search', :plugin => 'redmine_cms'  %>
  <%= javascript_include_tag 'codemirror/addon/search/searchcursor', :plugin => 'redmine_cms'  %>
  <%= javascript_include_tag 'codemirror/addon/dialog/dialog', :plugin => 'redmine_cms'  %>
  <%= javascript_include_tag 'codemirror/mode/htmlmixed/htmlmixed', :plugin => 'redmine_cms'  %>
  <%= javascript_include_tag 'codemirror/mode/css/css', :plugin => 'redmine_cms'  %>
  <%= javascript_include_tag 'codemirror/mode/xml/xml', :plugin => 'redmine_cms'  %>
  <%= javascript_include_tag 'codemirror/mode/javascript/javascript', :plugin => 'redmine_cms'  %>
  <%= javascript_include_tag 'redmine_cms', :plugin => 'redmine_cms'  %>
  <%= stylesheet_link_tag 'codemirror/codemirror', :plugin => 'redmine_cms'  %>
  <%= stylesheet_link_tag 'codemirror/theme/ambiance', :plugin => 'redmine_cms'  %>
<% end %>


<% content_for :header do %>
  <div class="contextual page-edit" id="float_buttons">
    <%= link_to l(:label_cms_apply), "#", :class => "icon icon-checked", :remote => true, :onclick => "editor.save(); $.ajax({url: '#{escape_javascript url_for(@part)}', type: \'post\', data: $(\'#part_form\').serialize()});return false;"%>
  </div>
<% end %>

